<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ronnie Ruchal – OT & Salary Tracker</title>

<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;background:#f1f5f9}
.app{max-width:430px;margin:auto;background:#fff;padding:18px;border-radius:18px;margin-top:15px;box-shadow:0 10px 25px rgba(0,0,0,.1)}
h2{text-align:center;color:#1e3a8a;margin:4px 0}
.sub{text-align:center;font-size:12px;color:#64748b;margin-bottom:14px}
label{font-weight:600;color:#1e40af;font-size:14px}
select,input{width:100%;padding:10px;margin-top:6px;border:2px solid #3b82f6;border-radius:10px;font-size:15px}
button{width:100%;padding:14px;border:none;border-radius:12px;background:#2563eb;color:#fff;font-weight:700;margin-top:14px}
.row{margin-bottom:12px}
.summary{background:#0f172a;color:#fff;padding:14px;border-radius:14px;margin-top:18px}
.summary h3{margin:0;font-size:14px;opacity:.8}
.total{font-size:28px;font-weight:800;color:#4ade80}
table{width:100%;margin-top:16px;border-collapse:collapse}
th,td{padding:8px;font-size:13px;border-bottom:1px solid #e5e7eb}
th{font-size:11px;color:#94a3b8}
.del{background:#fee2e2;color:#ef4444;border:none;padding:4px 7px;border-radius:6px;font-size:11px}
.footer{text-align:center;font-size:11px;color:#94a3b8;margin-top:20px}
</style>
</head>

<body>
<div class="app">
<h2>Ronnie Ruchal</h2>
<div class="sub">OT & Salary Tracker • v1.0.0</div>

<div class="row">
<label>Hourly Rate (₩)</label>
<input type="number" id="rate" value="10000">
</div>

<div class="row">
<label>Date</label>
<select id="dateSel"></select>
</div>

<div class="row">
<label>Day Type</label>
<select id="dayType">
  <option value="weekday">Weekday (Mon–Fri)</option>
  <option value="saturday">Saturday</option>
  <option value="sunday">Sunday</option>
  <option value="holiday">Public Holiday</option>
</select>
</div>

<div class="row">
<label>Worked Today?</label>
<select id="worked">
  <option value="yes">Yes</option>
  <option value="no">No</option>
</select>
</div>

<div class="row" id="timeRow">
<label>Out Time</label>
<select id="outTime">
  <option value="">Select</option>
  <option value="18:00">6:00 PM</option>
  <option value="18:30">6:30 PM</option>
  <option value="19:00">7:00 PM</option>
  <option value="19:30">7:30 PM</option>
  <option value="20:00">8:00 PM</option>
  <option value="20:30">8:30 PM</option>
  <option value="21:00">9:00 PM</option>
  <option value="21:30">9:30 PM</option>
  <option value="22:00">10:00 PM</option>
  <option value="22:30">10:30 PM</option>
  <option value="23:00">11:00 PM</option>
  <option value="23:30">11:30 PM</option>
  <option value="24:00">12:00 AM</option>
</select>
</div>

<button onclick="save()">Save</button>

<div class="summary">
<h3>Selected Month Total</h3>
<div class="total" id="total">₩0</div>
</div>

<table>
<thead>
<tr><th>Date</th><th>Type</th><th>Amount</th><th></th></tr>
</thead>
<tbody id="list"></tbody>
</table>

<div class="footer">Ronnie Ruchal • OT System v1.0.0</div>
</div>

<script>
const KEY="ronnie_ot_v1";

function setupDates(){
  let s=document.getElementById("dateSel");
  for(let i=0;i<4;i++){
    let d=new Date();d.setDate(d.getDate()-i);
    let v=d.toISOString().slice(0,10);
    let t=i==0?"Today":i==1?"Yesterday":i+" days ago";
    s.innerHTML+=`<option value="${v}">${t} (${v})</option>`;
  }
}
setupDates();

document.getElementById("worked").onchange=()=>{
  document.getElementById("timeRow").style.display=
    document.getElementById("worked").value==="yes"?"block":"none";
};

function save(){
  let date=dateSel.value,day=dayType.value,workedVal=worked.value;
  let rate=+document.getElementById("rate").value;
  let data=JSON.parse(localStorage.getItem(KEY))||[];
  if(data.find(e=>e.date===date)){alert("Already saved");return;}

  let amount=0;
  if(workedVal==="yes"){
    let t=outTime.value;if(!t){alert("Select time");return;}
    let mins=t==="24:00"?1440:+t.split(":")[0]*60+ +t.split(":")[1];
    let start=17*60+30;
    let normal=Math.max(0,Math.min(mins,22*60)-start)/60;
    let night=Math.max(0,mins-22*60)/60;

    if(day==="weekday"){
      amount=normal*rate*1.5+night*rate*3;
    }
    if(day==="saturday"||day==="holiday"){
      amount=8*rate*1.5 + Math.max(0,normal-8)*rate*1.5 + night*rate*3;
    }
    if(day==="sunday"){
      amount=(normal+night)*rate*1.5 + night*rate*1.5;
    }
  }else{
    if(day==="sunday") amount=8*rate; // basic
  }

  data.push({id:Date.now(),date,day,amount});
  localStorage.setItem(KEY,JSON.stringify(data));
  render();
}

function render(){
  let data=JSON.parse(localStorage.getItem(KEY))||[];
  let month=new Date().toISOString().slice(0,7);
  let total=0,html="";
  data.forEach(e=>{
    if(e.date.startsWith(month)) total+=e.amount;
    html+=`<tr>
      <td>${e.date}</td>
      <td>${e.day}</td>
      <td>₩${Math.round(e.amount)}</td>
      <td><button class="del" onclick="del(${e.id})">Del</button></td>
    </tr>`;
  });
  list.innerHTML=html;
  document.getElementById("total").innerText="₩"+Math.round(total);
}
function del(id){
  let d=JSON.parse(localStorage.getItem(KEY))||[];
  d=d.filter(x=>x.id!==id);
  localStorage.setItem(KEY,JSON.stringify(d));
  render();
}
render();
</script>
</body>
</html>
